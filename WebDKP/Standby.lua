function WebDKP_Standby_GUIToggle(a,b,c)local d=WebDKP_GetTableid()if b==nil or b==""then b=WebDKP_Standby_FrameAddStandby:GetText()end;if b==nil or b==""then playernametable=WebDKP_GetSelectedPlayers(1)if playernametable~=nil then b=playernametable[0]["name"]end end;if b==nil or b==""then WebDKP_Print(WebDKP.translations.Standby_Print)else if a=="add"then if WebDKP_DkpTable[b]==nil or WebDKP_DkpTable[b].class==nil then if c~=nil then local e=select(1,GetPlayerInfoByGUID(c))if WebDKP_DkpTable[b]==nil then WebDKP_DkpTable[b]={["dkp_"..d]=0,["class"]=e,["standby"]=1,["cantrim"]=false}else WebDKP_DkpTable[b]["class"]=e;WebDKP_DkpTable[b]["standby"]=1 end;WebDKP_SendWhisper(b,WebDKP.translations.Standby_SendWhisper)WebDKP_UpdateTableToShow()WebDKP_UpdateTable()else local f=CreateFrame("frame")f:RegisterEvent("CHAT_MSG_SYSTEM")f:SetScript("OnEvent",function(self,g,h)if g=="CHAT_MSG_SYSTEM"then if string.find(h,"["..b.."]")or string.find(h,"共计0个玩家")then self:UnregisterEvent("CHAT_MSG_SYSTEM")self=nil else return end;local i,j=C_FriendList.GetNumWhoResults()local e;for k=1,j do local l=C_FriendList.GetWhoInfo(k)if l.fullName==b then e=l.classStr;break end end;if e==nil then WebDKP_Print("未找到名为:["..b.."]的在线玩家")return end;if WebDKP_DkpTable[b]==nil then WebDKP_DkpTable[b]={["dkp_"..d]=0,["class"]=e,["standby"]=1,["cantrim"]=false}else WebDKP_DkpTable[b]["class"]=e;WebDKP_DkpTable[b]["standby"]=1 end;WebDKP_SendWhisper(b,WebDKP.translations.Standby_SendWhisper)WebDKP_UpdateTableToShow()WebDKP_UpdateTable()end end)C_FriendList.SetWhoToUi(false)C_FriendList.SendWho('n-\"'..b..'\"')end else WebDKP_DkpTable[b]["standby"]=1;WebDKP_SendWhisper(b,WebDKP.translations.Standby_SendWhisper)end end;if a=="remove"then if WebDKP_DkpTable[b]==nil then WebDKP_Print(WebDKP.translations.Standby_Print2)else WebDKP_DkpTable[b]["standby"]=0;WebDKP_SendWhisper(b,WebDKP.translations.Standby_SendWhisper2)end end;WebDKP_UpdateTableToShow()WebDKP_UpdateTable()end end;function WebDKP_Standby_Reset()for m,n in pairs(WebDKP_DkpTable)do if type(n)=="table"then n["standby"]=0 end end;WebDKP_UpdateTableToShow()WebDKP_UpdateTable()end